# API Stages - VoiceMock AI Interview Coach

This document defines the processing stages for the interview turn lifecycle.
Each stage is returned in error responses to help clients understand where failures occur.

## Stage Definitions

| Stage    | Description                                    | Example Errors                        |
|----------|------------------------------------------------|---------------------------------------|
| upload   | Audio file upload and validation               | Invalid format, file too large        |
| stt      | Speech-to-Text transcription                   | Transcription failed, audio unclear   |
| llm      | Language Model processing                      | Rate limit, context too long          |
| tts      | Text-to-Speech generation                      | Voice unavailable, synthesis failed   |
| unknown  | Unclassified or unexpected errors              | Internal server error                 |

## Usage in Error Responses

Error responses include the stage in the error object:

```json
{
  "data": null,
  "error": {
    "code": "stt_transcription_failed",
    "stage": "stt",
    "message": "Could not transcribe audio",
    "request_id": "abc123"
  },
  "request_id": "abc123"
}
```

## Stage Progression

A successful turn flows through stages sequentially:
1. `upload` → Audio received and validated
2. `stt` → Audio transcribed to text
3. `llm` → Response generated by interviewer
4. `tts` → Response converted to speech

Failures at any stage short-circuit the flow and return immediately.
